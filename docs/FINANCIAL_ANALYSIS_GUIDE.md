# 재무제표 분석 파이프라인 가이드

앨리스 스미스 작성 ✨  
`src/data/processed/` 폴더의 JSON 파일만을 이용해 **처음부터 끝까지** 재무제표를 분석하는 전체 절차를 정리했습니다.

---

## 목차

1. 데이터 파악 & 분류
2. 로딩 & 정규화 (ETL)
3. 핵심 지표 추출 (Mapping Rules)
4. 시계열 구성 & 정합성 검증
5. 재무비율 계산 규칙
6. 점수화 & 등급 부여
7. 인사이트 & 추천 생성
8. 산출물 구조 예시
9. 품질 관리 체크리스트
10. 협업 팁

---

## 1. 데이터 파악 & 분류

| 구분      | 예시 파일명                                                                             | 의미                                         |
| --------- | --------------------------------------------------------------------------------------- | -------------------------------------------- |
| 형식      | `2025_1분기보고서_02_손익계산서_20250606.json`                                          | `<연도>_<분기>보고서_<코드>_<표명>_<작성일>` |
| 코드      | `01` 재무상태표, `02` 손익계산서, `03` 포괄손익계산서, `04` 현금흐름표, `05` 자본변동표 |
| 연결 여부 | 파일명에 `_연결_` 포함 시 연결재무제표                                                  |

1. **회사 식별**  
   • 파일 내용의 `종목코드` 또는 상위 경로 인덱스를 통해 결정
2. **동일 회사·보고기간·표 종류**끼리만 묶어 집계

---

## 2. 로딩 & 정규화 (ETL)

```ts
const raw = JSON.parse(fs.readFileSync(path, 'utf-8')) as RawItem[]
```

1. **숫자 변환** : 콤마 제거 → 단위 통일 (천원 기준) → `Number` 변환
2. **컬럼명 클렌징** : 공백·탭·특수문자 제거 후 표준 문자열 사용
3. **연결 우선 원칙** : 연결 데이터가 있으면 개별은 참고용으로만 사용

---

## 3. 핵심 지표 추출 (Mapping Rules)

```ts
const map = {
  매출액: ['매출액','Ⅰ. 매출액','총매출액', …],
  영업이익: ['영업이익','영업이익(손실)'],
  // …
};
```

- **우선순위** : `당기 1분기 누적` → `당기 1분기 3개월`
- **전년 동기 데이터** : `전기 1분기 누적` 또는 `전기 1분기 3개월` 저장

---

## 4. 시계열 구성 & 정합성 검증

1. **분기 합 vs 연간** : `Σ1Q … 4Q`와 `4Q 누적` 값 오차 ≤ 5 %
2. **재무상태표 등식** : `자산 = 부채 + 자본`, 오차 ≤ 1 %

---

## 5. 재무비율 계산 규칙

| 영역   | 비율           | 공식                          |
| ------ | -------------- | ----------------------------- |
| 수익성 | 영업이익률     | `영업이익 ÷ 매출액 × 100`     |
|        | 순이익률       | `당기순이익 ÷ 매출액 × 100`   |
|        | ROA            | `당기순이익 ÷ 자산총계 × 100` |
|        | ROE            | `당기순이익 ÷ 자본총계 × 100` |
| 안정성 | 부채비율       | `부채총계 ÷ 자본총계 × 100`   |
|        | 유동비율       | `유동자산 ÷ 유동부채 × 100`   |
|        | 자기자본비율   | `자본총계 ÷ 자산총계 × 100`   |
| 성장성 | 매출액증가율   | `(당기-전년)/전년 × 100`      |
| 활동성 | 총자산회전율   | `매출액 ÷ 자산총계`           |
|        | 재고자산회전율 | `매출액 ÷ 재고자산`           |

---

## 6. 점수화 & 등급 부여

1. **Threshold Table** (예시)
   - 영업이익률: _Excellent ≥ 15 %_ … _Poor < 0 %_
   - 부채비율: _Excellent ≤ 30 %_ … _Poor ≥ 200 %_
2. **calculateScore()**
   - 높을수록 좋음 → 값이 클수록 고득점
   - 낮을수록 좋음(부채비율 등) → 반대 방식
3. **가중평균**  
   `수익성 40 % + 안정성 30 % + 성장성 20 % + 활동성 10 %`
4. **등급** : S ≥ 90, A ≥ 80, B ≥ 70, C ≥ 60, 그 외 D

---

## 7. 인사이트 & 추천 생성

- 영역 점수 < 60 → 개선 권고 메시지
- 영역 점수 ≥ 80 → 우수 메시지
- 성장성 음수 → 매출 감소 경고
- 종합 등급 S/A → “장기투자 매력”
- 종합 등급 D → “추가 실사 필요”

---

## 8. 산출물 구조 예시

```jsonc
{
  "companyName": "ABC전자",
  "reportDate": "2025Q1",
  "extracted": {
    /* 핵심 숫자 */
  },
  "ratios": {
    /* 계산된 비율 */
  },
  "scores": {
    /* 0~100 */
  },
  "grade": "A",
  "recommendations": [
    "✅ 우수한 수익성을 보이고 있습니다…",
    "🛡️ 안정적인 재무구조입니다…"
  ]
}
```

---

## 9. 품질 관리 체크리스트

- [ ] 단위(천원/백만원) 혼재 시 통일
- [ ] 연결/개별 중복 시 **연결 우선**
- [ ] 비경상적 손익 분리(일회성 손실·이익)
- [ ] 감사의견 _한정·부적정_ 여부 표시
- [ ] 산업 평균 대비 차이 % 표시

---

## 10. 협업 팁

| 역할        | 주의사항                               |
| ----------- | -------------------------------------- |
| 데이터팀    | 신규 항목 등장 시 매핑 테이블 업데이트 |
| 개발팀      | JSON 스키마 변경 시 타입 명세 공유     |
| 기획·디자인 | 추천 메시지·색상·이모지 톤 & 매너 관리 |

---

**끝!**  
궁금한 점이 있으면 언제든 말씀해 주세요. 🌟
